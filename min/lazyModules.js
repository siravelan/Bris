app.controller("weatherCtrl",["$http","$scope","$window","$location",function(k,f,n,h){var a=this;f.master.data=[];a.timezone=-((new Date).getTimezoneOffset()/60);a.rawdata=[];for(var b in f.master.recents)f.master.recents.hasOwnProperty(b)&&18E5<Date.now()-f.master.recents[b].info.savedAt&&navigator.onLine&&delete f.master.recents[b];if(f.master.recents.hasOwnProperty(h.path()))f.master.location=f.master.recents[h.path()].info.location,f.master.data=f.master.recents[h.path()].data;else{var d=function(){k.get("https://real-timer-server.tk:2087/ip-data.php").success(function(a){r({coords:{latitude:a.lat,
longitude:a.lon}})})},r=function(b){console.log("Position accessed successfully",b);f.master.location=f.master.textData.yourExactPosition;b="https://real-timer-server.tk:2087/get-weather.php?lat="+b.coords.latitude+"&long="+b.coords.longitude+"&gmt="+a.timezone+"&d="+Math.round(Date.now()/18E5);k.get(b).success(function(d){Array.prototype.push.apply(a.rawdata,d.data);d=[];for(var g=0;g<a.rawdata.length;g++){var b=a.rawdata[g].icon;a.rawdata[g].offset=!1;a.rawdata[g].showImg=!0;if(/^[\d]+$/.test(b))a.rawdata[g].background=
"",a.rawdata[g].foreground="src/img/modern-icons/"+b+".png";else if(/^\d+d$/.test(b))"01d"==b?(a.rawdata[g].background="",a.rawdata[g].foreground="src/img/modern-icons/01db.png"):"02d"==b?(a.rawdata[g].background="src/img/modern-icons/01db.png",a.rawdata[g].foreground="src/img/modern-icons/02f.png"):(a.rawdata[g].background="src/img/modern-icons/db.png",a.rawdata[g].foreground="src/img/modern-icons/"+b.substring(0,2)+"f.png");else if(/^\d+m$/.test(b))a.rawdata[g].background="01m"==b?"src/img/modern-icons/01mb.png":
"src/img/modern-icons/mb.png",a.rawdata[g].foreground="src/img/modern-icons/"+b.substring(0,2)+"f.png";else if(/^mf\/\d+n\.\d+$/.test(b)){var k=b.substring(7,9);/^mf\/0[12]n\.\d{2}$/.test(b)||(a.rawdata[g].offset=!0);a.rawdata[g].phase=50>=k?.5*-k:25-.5*(k-50);"01"===b.substring(3,5)?a.rawdata[g].showImg=!1:a.rawdata[g].foreground="src/img/modern-icons/"+b.substring(3,5)+"f.png"}b=Number(a.rawdata[g].date);"undefined"===typeof d[b]&&(d[b]=[]);d[b].push(a.rawdata[g])}g=[];b=(new Date).getUTCDate();
k=(new Date((new Date).getFullYear(),(new Date).getUTCMonth(),0)).getDate();for(var p=b;p<b+k;p++){var c=p>k?p-k:p;if("undefined"!==typeof d[c]){var e={data:[]};if(4<d[c].length){for(var l=0;l<d[c].length;l++){var m=Number(d[c][l].hour);m=6>m?0:12>m?1:18>m?2:3;"undefined"===typeof e.data[m]&&(e.data[m]={data:[]});e.data[m].data.push(d[c][l])}e.data.clean();for(c=0;c<e.data.length;c++){l=e.data[c].data[0];m=e.data[c].data.slice(-1)[0];e.data[c].hour=l.hour;e.data[c].hourTo=m.hour;e.data[c].background=
l.background;e.data[c].foreground=l.foreground;e.data[c].icon=l.icon;e.data[c].offset=l.offset;e.data[c].phase=l.phase;e.data[c].summarizeable=!0;e.data[c].currently_summarized=!0;for(var n=m=l=0,q=0;q<e.data[c].data.length;q++)l+=Number(e.data[c].data[q].degs),m+=Number(e.data[c].data[q].precipitation),n+=Number(e.data[c].data[q].wind);e.data[c].degs=Math.round(l/e.data[c].data.length);e.data[c].precipitation=Math.round(100*m)/100;e.data[c].wind=Math.round(n/e.data[c].data.length)}c=(new Date(1E3*
e.data[0].data[0].unix)).getDay();e.day=f.master.textData.weekdays[0<c?c-1:6]}else{e.data=d[c];for(c=0;c<e.data.length;c++)e.data[c].data=[],e.data[c].summarizeable=!1,e.data[c].currently_summarized=!0;c=(new Date(1E3*e.data[0].unix)).getDay()}e.day=f.master.textData.weekdays[0<c?c-1:6];g.push(e)}}f.master.data=g;f.master.recents[h.path()]={data:g,info:{url:h.path(),location:f.master.location,savedAt:Date.now()}};"undefined"!==typeof Storage&&(localStorage.recents=JSON.stringify(f.master.recents))}).error(function(b,
a){d()})};("undefined"===typeof Storage||"undefined"!==typeof Storage&&"true"!=localStorage.hideFlipDeviceTip)&&515>=window.innerWidth&&(f.master.hideFlipDeviceTip=!1);3<h.path().length?alert("Fetching using place name is not implemented yet!"):navigator.geolocation?(console.log("Trying to fetch position"),navigator.geolocation.getCurrentPosition(r,d)):d()}angular.element(n).on("resize",function(){f.$apply(function(){f.master.height=window.innerHeight;f.master.width=window.innerWidth;515<f.master.width&&
(f.master.hideFlipDeviceTip=!0,"undefined"!==typeof Storage&&(localStorage.hideFlipDeviceTip=!0))})});"undefined"!==typeof Storage&&(localStorage.visits=Number(localStorage.visits||0)+1);Array.prototype.clean=function(b){for(var a=0;a<this.length;a++)this[a]==b&&(this.splice(a,1),a--);return this}}]);app.controller("searchController",["$http","$scope","$q","$sce",function(k,f,n,h){var a=this;a.query="";a.matches=[];a.error=!1;a.search=function(){k.get("https://real-timer-server.tk:2087/place-search.php?input="+a.query).success(function(b){console.log(b);a.matches=b.predictions;for(b=0;b<a.matches.length;b++){var d=a.matches[b].terms[a.matches[b].terms.length-1].value;"United States"==d&&(d="usa");"Iran"==d&&(d="irn");"United Kingdom"==d&&(d="gbr");"Germany"==d&&(d="deu");"Spain"==d&&(d="esp");
"Malaysia"==d&&(d="mys");"Malta"==d&&(d="mlt");"United Arab Emirates"==d&&(d="are");"Japan"==d&&(d="jpn");"Denmark"==d&&(d="dnk");"Philippines"==d&&(d="phl");a.matches[b].country=d.substr(0,3).toLowerCase()}})}}]);app.controller("cookieCtrl",["$timeout","$scope",function(k,f){function n(a,b){return(b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)"))?b.pop():""}var h=this;h.elem=document.getElementsByClassName("cookie-box")[0];h.template="";h.close=function(){h.elem=document.getElementsByClassName("cookie-box")[0];try{h.elem.setAttribute("style","opacity:0;")}catch(a){console.warn(a)}"undefined"!==typeof Storage?localStorage.cookieAccept="true":document.cookie="cookiescriptaccept=visit";k(function(){h.elem&&
h.elem.parentNode.removeChild(h.elem)},500)};"undefined"!==typeof Storage&&"true"!=localStorage.cookieAccept&&"visit"!=n("cookiescriptaccept")?k(function(){h.elem=document.getElementsByClassName("cookie-box")[0];h.elem.setAttribute("style","opacity:1;");k(h.close,5E3)},2500):h.elem&&h.elem.parentNode.removeChild(h.elem)}]);